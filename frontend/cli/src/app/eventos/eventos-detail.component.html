<div class="container evento-detail-container" *ngIf="evento">
  <div class="row justify-content-center">
    <div class="card shadow-sm mt-4">
      <div class="card-body">
        <h2 class="card-title text-center mb-4">{{ evento.nombre }}</h2>
        <p><strong>Fecha de creación:</strong> {{ evento.fechaDeCreacion | date:'dd-MM-yyyy' : '+00:00'}}</p>
        <p><strong>Fecha y hora:</strong> {{ evento.fechaHora | date:'short' }}</p>
        <p><strong>Ubicación:</strong> {{ evento.ubicacion }}</p>
        <p><strong>Descripción:</strong> {{ evento.descripcion }}</p>
        <p><strong>Cantidad máxima de participantes:</strong> {{ evento.cantidadMaximaParticipantes }}</p>

        <!-- Botón Inscribirse o Desinscribirse centrado -->
        <button class="btn btn-primary btn-block ingresar-button mx-auto"
          [disabled]="!(inscribirseValid() || salirValid()) || isLoading" (click)="salirValid() ? salir() : inscribirse()">
          {{ salirValid() ? 'Desinscribirse' : 'Inscribirse' }}
        </button>

        <!-- Botón de regresar centrado -->

        <!-- Botón Invitar Amigos centrado, visible solo si el usuario ya está inscrito -->
        <button *ngIf="botonInvitar()" (click)="abrirModalInvitarAmigos()" class="btn btn-success btn-block mx-auto mt-3">
          Invitar amigos
        </button>


        <ng-container *ngIf="creador">
          <h3>Miembros</h3>
          <ul>
            <li *ngFor="let miembro of miembros">
              {{ miembro.nombreUsuario }}
              <button *ngIf="(creador)" (click)="eliminarMiembro(miembro.id)">Eliminar Miembro</button>
            </li>
          </ul>
        </ng-container>

        <button *ngIf="creador" class="btn btn-primary" (click)="editarEvento()">Editar</button>
        <button *ngIf="creador" (click)="eliminarEvento()" class="btn btn-danger">Eliminar evento</button>


        <div *ngIf="isLoading" aria-label="Orange and tan hamster running in a metal wheel" role="img"
          class="wheel-and-hamster">
          <div class="wheel"></div>
          <div class="hamster">
            <div class="hamster__body">
              <div class="hamster__head">
                <div class="hamster__ear"></div>
                <div class="hamster__eye"></div>
                <div class="hamster__nose"></div>
              </div>
              <div class="hamster__limb hamster__limb--fr"></div>
              <div class="hamster__limb hamster__limb--fl"></div>
              <div class="hamster__limb hamster__limb--br"></div>
              <div class="hamster__limb hamster__limb--bl"></div>
              <div class="hamster__tail"></div>
            </div>
          </div>
          <div class="spoke"></div>
        </div>
        <!-- 
        <mat-progress-spinner *ngIf="isLoading" mode="indeterminate" diameter="24" color="primary"  class="spinner">
        </mat-progress-spinner>
        Botón de regresar -->
        <button (click)="goBack()" class="btn btn-secondary btn-block mt-2">Volver</button>

      </div>
    </div>
  </div>
</div>




<ng-template #modalInvitarAmigos>
  <div class="modal-header">
    <h5 class="modal-title">Invitar amigos al evento</h5>
    <button type="button" class="close btn-close" aria-label="Close" (click)="cerrarModal()"></button>
  </div>
  <div class="modal-body">
    <!-- Amigos no en evento -->
    <h6 class="text-primary">Amigos que aún no están en el evento</h6>
    <div *ngIf="amigosNoEnEvento.length > 0; else sinAmigosNoEnEvento">
      <div *ngFor="let amigo of amigosNoEnEvento"
        class="d-flex justify-content-between align-items-center mb-2 p-2 border-bottom">
        <span>{{ amigo.nombreUsuario }}</span>
        <button (click)="invitarAmigo(amigo.id)" class="btn btn-outline-primary btn-sm ml-2 animate-btn">
          Invitar al evento
        </button>
        <button (click)="goBack()" class="btn btn-secondary btn-block mt-2" [disabled]="isLoading">Volver</button>

      </div>
    </div>
    <ng-template #sinAmigosNoEnEvento>
      <p class="text-muted">No tienes amigos disponibles para invitar.</p>
    </ng-template>

    <!-- Amigos en evento -->
    <h6 class="text-success mt-4">Amigos ya en el evento</h6>
    <div *ngIf="amigosEnEvento.length > 0; else sinAmigosEnEvento">
      <div *ngFor="let amigo of amigosEnEvento"
        class="d-flex justify-content-between align-items-center mb-2 p-2 border-bottom">
        <span>{{ amigo.nombreUsuario }}</span>
        <span class="badge bg-success text-white">En el evento</span>
      </div>
    </div>
    <ng-template #sinAmigosEnEvento>
      <p class="text-muted">No tienes amigos en el evento.</p>
    </ng-template>

    <!-- Amigos ya invitados -->
    <h6 class="text-warning mt-4">Amigos ya invitados</h6>
    <div *ngIf="amigosYaInvitados.length > 0; else sinAmigosYaInvitados">
      <div *ngFor="let amigo of amigosYaInvitados"
        class="d-flex justify-content-between align-items-center mb-2 p-2 border-bottom">
        <span>{{ amigo.nombreUsuario }}</span>
        <span class="badge bg-warning text-dark">Ya invitado</span>
      </div>
    </div>
    <ng-template #sinAmigosYaInvitados>
      <p class="text-muted">No tienes amigos ya invitados.</p>
    </ng-template>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="cerrarModal()">Cerrar</button>
  </div>
</ng-template>